



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Manual for native XR APIs">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>XR SDK Display subsystem - XR SDK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../img/extra.css">
    
      <link rel="stylesheet" href="../../img/toggle.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#xr-sdk-display-subsystem" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="XR SDK" class="md-header-nav__button md-logo">
          
            <img src="../../img/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                XR SDK
              </span>
              <span class="md-header-nav__topic">
                XR SDK Display subsystem
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="XR SDK" class="md-nav__button md-logo">
      
        <img src="../../img/logo.png" width="48" height="48">
      
    </a>
    XR SDK
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../index.html" title="XR SDK Home" class="md-nav__link">
      XR SDK Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Interfaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Preinit
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Preinit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/preinit/index.html" title="XR SDK PreInit Interface" class="md-nav__link">
      XR SDK PreInit Interface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/preinit/changelog.html" title="PreInit Changelog" class="md-nav__link">
      PreInit Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/preinit/known-issues.html" title="Known issues" class="md-nav__link">
      Known issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Stats
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Stats
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/stats/index.html" title="XR SDK stats" class="md-nav__link">
      XR SDK stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/stats/changelog.html" title="Stats Changelog" class="md-nav__link">
      Stats Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../interfaces/stats/known-issues.html" title="Known issues" class="md-nav__link">
      Known issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Provider setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Provider setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../provider-setup/provider-setup.html" title="Creating an XR Provider" class="md-nav__link">
      Creating an XR Provider
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../provider-setup/unity-subsystems-manifest-json.html" title="UnitySubsystemsManifest.json" class="md-nav__link">
      UnitySubsystemsManifest.json
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Runtime discovery
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Runtime discovery
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../runtime-discovery/runtime-discovery.html" title="Runtime discovery and activation of subsystems" class="md-nav__link">
      Runtime discovery and activation of subsystems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../runtime-discovery/troubleshooting.html" title="Troubleshooting plug-in discovery at runtime" class="md-nav__link">
      Troubleshooting plug-in discovery at runtime
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Samples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Samples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../samples/samples.html" title="Samples" class="md-nav__link">
      Samples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Subsystems
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Subsystems
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1" checked>
    
    <label class="md-nav__link" for="nav-6-1">
      Display
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        Display
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        XR SDK Display subsystem
      </label>
    
    <a href="index.html" title="XR SDK Display subsystem" class="md-nav__link md-nav__link--active">
      XR SDK Display subsystem
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#texture-allocation" title="Texture allocation" class="md-nav__link">
    Texture allocation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#msaa" title="MSAA" class="md-nav__link">
    MSAA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#srgb" title="sRGB" class="md-nav__link">
    sRGB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depth-textures" title="Depth textures" class="md-nav__link">
    Depth textures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-double-and-triple-buffering" title="Handling double and triple buffering" class="md-nav__link">
    Handling double and triple buffering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-lifecycle" title="Frame lifecycle" class="md-nav__link">
    Frame lifecycle
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blocking-for-cadence" title="Blocking for cadence" class="md-nav__link">
    Blocking for cadence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-to-wait-for-cadence" title="Where to wait for cadence" class="md-nav__link">
    Where to wait for cadence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submitting-frames-in-flight" title="Submitting frames in-flight" class="md-nav__link">
    Submitting frames in-flight
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filling-out-next-frame-descriptor" title="Filling out next frame descriptor" class="md-nav__link">
    Filling out next frame descriptor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#render-passes" title="Render passes" class="md-nav__link">
    Render passes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#culling-passes" title="Culling passes" class="md-nav__link">
    Culling passes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="changelog.html" title="Display Changelog" class="md-nav__link">
      Display Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="known-issues.html" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      Input
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        Input
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../input/index.html" title="XR Input Subsystem" class="md-nav__link">
      XR Input Subsystem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../input/changelog.html" title="Input Changelog" class="md-nav__link">
      Input Changelog
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../input/known-issues.html" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      Meshing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        Meshing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../meshing/index.html" title="XR SDK Meshing subsystem" class="md-nav__link">
      XR SDK Meshing subsystem
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#texture-allocation" title="Texture allocation" class="md-nav__link">
    Texture allocation
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#msaa" title="MSAA" class="md-nav__link">
    MSAA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#srgb" title="sRGB" class="md-nav__link">
    sRGB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#depth-textures" title="Depth textures" class="md-nav__link">
    Depth textures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handling-double-and-triple-buffering" title="Handling double and triple buffering" class="md-nav__link">
    Handling double and triple buffering
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frame-lifecycle" title="Frame lifecycle" class="md-nav__link">
    Frame lifecycle
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blocking-for-cadence" title="Blocking for cadence" class="md-nav__link">
    Blocking for cadence
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-to-wait-for-cadence" title="Where to wait for cadence" class="md-nav__link">
    Where to wait for cadence
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#submitting-frames-in-flight" title="Submitting frames in-flight" class="md-nav__link">
    Submitting frames in-flight
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filling-out-next-frame-descriptor" title="Filling out next frame descriptor" class="md-nav__link">
    Filling out next frame descriptor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#render-passes" title="Render passes" class="md-nav__link">
    Render passes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#culling-passes" title="Culling passes" class="md-nav__link">
    Culling passes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="xr-sdk-display-subsystem">XR SDK Display subsystem<a class="headerlink" href="#xr-sdk-display-subsystem" title="Permanent link">&para;</a></h1>
<p><a href="changelog.html">Changelog</a></p>
<p>This subsystem provides an interface for texture allocation, frame lifecycle, and blocking for cadence.</p>
<h2 id="texture-allocation">Texture allocation<a class="headerlink" href="#texture-allocation" title="Permanent link">&para;</a></h2>
<p>Several device SDKs require that a texture is allocated through the SDK itself rather than the usual graphics APIs. If you use the XR SDK Display Subsystem, you no longer need to rely on external plug-ins to blit or copy into the SDK texture.</p>
<p>The Display subsystem enables a plug-in Provider to allocate the texture. Where possible, Unity renders directly to the texture to avoid unnecessary copies. Unity can also allocate the texture for you if needed.</p>
<p>In the following cases, Unity can&rsquo;t render directly to the texture and instead renders to intermediate textures and then blits or copies to your texture:</p>
<ul>
<li>If image effects are in use, your texture will be last in the chain.</li>
<li>On PC with MSAA, Unity renders to a multisampled texture and then resolves into your texture at the end of the camera stack.</li>
<li>On mobile, with the multisample auto resolve extension, the texture will be implicitly resolved when the texture is flushed or used as a source or destination for any operation other than drawing to it. See <code>EXT_multisampled_render_to_texture</code> extension.</li>
<li>Deferred rendering, HDR, and command buffers cause Unity to render to intermediate textures.</li>
<li>If rendering to a subset of the screen, Unity renders to intermediate textures.</li>
<li>If the &ldquo;texture layout&rdquo; doesnâ€™t match what Unity is rendering to (for example, Unity is rendering each eye to separate textures, but the RenderPass is configured to render to a texture array or a single texture).</li>
<li>If the <code>kUnityXRRenderTextureFlagsLockedWidthHeight</code> flag is set and renderScale is not 1.0.</li>
<li>If the <code>kUnityXRRenderTextureFlagsWriteOnly</code> flag is set and Unity needs to read back from the texture.</li>
</ul>
<h3 id="msaa">MSAA<a class="headerlink" href="#msaa" title="Permanent link">&para;</a></h3>
<p>Both on PC and mobile, the engine will always resolve to the provider&rsquo;s texture.  The engine will perform implicit resolve (on mobiles with multi-sample render to texture extension) or explicit resolve.</p>
<p>On mobile, providers should enable the <code>kUnityXRRenderTextureFlagsAutoResolve</code> flag and create their textures with 1 sample.</p>
<h3 id="srgb">sRGB<a class="headerlink" href="#srgb" title="Permanent link">&para;</a></h3>
<p>Use <code>UnityXRFrameSetupHints.appSetup.sRGB</code> to check if Unity expects to render to sRGB texture formats. The Provider ultimately selects the output texture format from the <code>colorFormat</code> field of <code>UnityXRRenderTextureDesc</code>. If the format is an sRGB type, UNity turns sRGB writes on or off depending on the color space that the active Project selects. You should always sample from any sRGB textures with sRGB to linear conversion in your compositor.</p>
<h3 id="depth-textures">Depth textures<a class="headerlink" href="#depth-textures" title="Permanent link">&para;</a></h3>
<p>If your SDK needs depth information, you can obtain the depth buffer in the same way as the color buffer above. The <code>nativeDepthTex</code> value on the <code>UnityXRRenderTextureDesc</code> specifies the native resource. By default, Unity tries to share the depth buffer between textures with a similar desc if <code>nativeDepthTex</code> is set to <code>kUnityXRRenderTextureIdDontCare</code>.</p>
<p>If your SDK does not need depth information, you should set <code>UnityXRRenderTextureDesc::depthFormat</code> to <code>kUnityXRDepthTextureFormatNone</code> to avoid unnecessary resolves.</p>
<h3 id="handling-double-and-triple-buffering">Handling double and triple buffering<a class="headerlink" href="#handling-double-and-triple-buffering" title="Permanent link">&para;</a></h3>
<p>During submission (see <a href="#submitting-frames-in-flight">Submitting frames in-flight</a>), you can specify a different texture ID each frame in order to handle the case where the SDK needs to double- or triple-buffer images that Unity is rendering to. The Provider plug-in is responsible for managing the collection of <code>UnityXRRenderTextureId</code>s.</p>
<h2 id="frame-lifecycle">Frame lifecycle<a class="headerlink" href="#frame-lifecycle" title="Permanent link">&para;</a></h2>
<p>There are two methods responsible for the lifecycle of a frame: <code>PopulateNextFrameDesc</code>, which happens right before rendering begins, and <code>SubmitCurrentFrame</code>, which happens immediately after rendering has completed. Both methods are called on the graphics thread. </p>
<p>During <code>PopulateNextFrameDesc</code>, the display Provider is expected to do the following:</p>
<ul>
<li>Wait for cadence (wait until Unity should start submitting rendering commands again). Alternatively, this can be done in <code>SubmitCurrentFrame</code>.</li>
<li>Acquire the next image and tell Unity what texture ids to render to next via the <code>nextFrame</code> parameter.</li>
</ul>
<p>During the <code>SubmitCurrentFrame</code> method, the display Provider is expected to do the following:</p>
<ul>
<li>Submit the last frame in-flight (for example, eye textures or depth textures) to display on the screen.</li>
<li>Wait for cadence, as an alternative to waiting during <code>PopulateNextFrameDesc</code>.</li>
</ul>
<h3 id="blocking-for-cadence">Blocking for cadence<a class="headerlink" href="#blocking-for-cadence" title="Permanent link">&para;</a></h3>
<p>To maintain the lowest possible latency and maximal throughput when rendering to an HMD display, you need to ensure precise timing when you obtain poses and submit textures. Each HMD has a native refresh rate that their compositor runs at. Rendering any faster than that rate results in a sub-optimal experience because of mismatched timing or redundant work.</p>
<p>Unity expects the display Provider to block, or wait for frame cadence, during the frame lifecycle. Unity starts submitting rendering commands shortly after &lsquo;waking up&rsquo; from the blocking call. You should synchronize the wake-up time to your compositor within a particular window. Some SDKs provide a floating wake-up time window based on heuristics. Oculus calls this the &ldquo;queue ahead&rdquo; (see <a href="https://developer.oculus.com/documentation/pcsdk/latest/concepts/dg-render/?locale=en_US#adaptive-queue-ahead">Oculus developer documentation</a> for more information). Valve calls it &ldquo;running start&rdquo; (see slides 18 and 19 of <a href="http://media.steampowered.com/apps/valve/2015/Alex_Vlachos_Advanced_VR_Rendering_GDC2015.pdf">this presentation</a>).</p>
<p>Unity waits on the frame lifecycle to complete before it starts submitting pose-dependent graphics commands.</p>
<h4 id="where-to-wait-for-cadence">Where to wait for cadence<a class="headerlink" href="#where-to-wait-for-cadence" title="Permanent link">&para;</a></h4>
<p>Providers can wait for cadence in either <code>PopulateNextFrameDesc</code> or in <code>SubmitCurrentFrame</code>.</p>
<p>While Unity submits graphics commands for a frame on the graphics thread, the next frame&rsquo;s simulation loop is running on the main thread. It contains physics, script logic, etc. <code>PopulateNextFrameDesc</code> is called on the graphics thread after all rendering commands have been submitted, and only after the simulation of the next frame and all graphics jobs scheduled on it are complete. One of the graphics job that <code>PopulateNextFrameDesc</code> waits for is <code>SubmitCurrentFrame</code> for the current frame. This is why it&rsquo;s valid to wait for cadence in <code>SubmitCurrentFrame</code>. Furthermore, Unity doesn&rsquo;t start rendering until <code>PopulateNextFrameDesc</code> is complete.</p>
<p>With these details in mind, there are some trade-offs to waiting for cadence in <code>SubmitCurrentFrame</code> as opposed to <code>PopulateNextFrameDesc</code>. For example, waiting for cadence in <code>SubmitCurrentFrame</code> can cause performance issues if the application schedules expensive graphics jobs during simulation. Because <code>SubmitCurrentFrame</code> is scheduled to run after rendering, the graphics jobs that the application scheduled will run after <code>SubmitCurrentFrame</code>, but before <code>PopulateNextFrameDesc</code>. In this case, the Provider is waiting in <code>SubmitCurrentFrame</code>, then it wakes up expecting Unity to begin rendering. However, Unity processes the graphics jobs the application scheduled before it calls <code>PopulateNextFrameDesc</code>, which in turn allows Unity to start rendering. This delay between waking up for rendering and processing the graphics jobs scheduled in the update method could cause latency. Developers can optimize this by scheduling their graphics jobs <a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.OnPostRender.html">after rendering</a> to ensure the graphics jobs are scheduled before <code>SubmitCurrentFrame</code>. </p>
<p>While the Provider is waiting for cadence in <code>SubmitCurrentFrame</code> allows computing graphics jobs to run in parallel to the main thread, waiting for cadence in <code>PopulateNextFrameDesc</code> blocks the Unity main thread entirely. This is acceptable because simulation and other graphics jobs have already completed. Problems might occur when the simulation or graphics thread take up far too much time and exceed the device&rsquo;s target framerate. This can cause framerates to be cut in half while <code>PopulateNextFrameDesc</code> waits for the next cycle in the cadence.</p>
<h3 id="submitting-frames-in-flight">Submitting frames in-flight<a class="headerlink" href="#submitting-frames-in-flight" title="Permanent link">&para;</a></h3>
<p>When Unity calls <code>SubmitCurrentFrame</code>, the textures that you&rsquo;ve set up last frame have been rendered to, or Unity has submitted render commands to the graphics driver to render them. Unity is now done with them and you can pass them on to your compositor.</p>
<h3 id="filling-out-next-frame-descriptor">Filling out next frame descriptor<a class="headerlink" href="#filling-out-next-frame-descriptor" title="Permanent link">&para;</a></h3>
<p>After blocking or acquiring the next frame to render to, you must tell Unity which textures to render to in the next frame, and what&rsquo;s the layout of the render passes (see Render Passes below).</p>
<h4 id="render-passes">Render passes<a class="headerlink" href="#render-passes" title="Permanent link">&para;</a></h4>
<p>A <code>UnityXRRenderPass</code> can involve a culling pass and a scene graph traversal. This is a resource-intensive operation, and you should try to limit the number of times Unity performs it via tricks like single-pass rendering.</p>
<p>Each <code>UnityXRRenderPass</code> contains an output texture (which can be a texture array), and output <code>UnityXRRenderParams</code> such as view, projection matrices, and the rect to render to or the texture array slice.</p>
<p>For each frame, the display Provider sets up a <code>UnityXRRenderPass</code> and fills out the <code>UnityXRRenderTextureId</code>s that Unity will render to the next frame.</p>
<p>Use cases for <code>UnityXRRenderPass</code> include the following:</p>
<ul>
<li>Two-pass stereo rendering (2 RenderPass x 1 RenderParams)</li>
<li>Single pass stereo rendering (1 RenderPass x 2 RenderParams)</li>
</ul>
<p>The API supports these additional cases (but Unity might not react correctly right now):</p>
<ul>
<li>Quad pass wide FOV stereo rendering (4 RenderPass x 1 RenderParams)</li>
<li>Single pass + wide FOV stereo rendering (1 RenderPass x 2 RenderParams + 2 RenderPass x 1 RenderParams)</li>
<li>Foveated rendering:<ul>
<li>two separate textures for each eye (inner and outer)</li>
<li>one texture, UV fitting</li>
</ul>
</li>
<li>External view scenario (HoloLens BEV, Mayo 3rd eye) (extra RenderPass)</li>
<li>Near / far rendering for compositing objects or people in scene (2 RenderPass, different projections, different targets)</li>
</ul>
<p>It&rsquo;s safe to make these assumptions:</p>
<ul>
<li>One texture per pass (singlepass will be one texture-array)</li>
<li>If single-pass, two pose / projections per pass (or foveated rendering)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Unity Project and XR SDK must use the same setting (enabled/disabled) for single-pass rendering, because this setting affects user shaders. To check if single-pass rendering is enabled, use <code>UnityXRFrameSetupHints.appSetup.singlePassRendering</code>.</p>
</div>
<h4 id="culling-passes">Culling passes<a class="headerlink" href="#culling-passes" title="Permanent link">&para;</a></h4>
<p>Two rendering passes can share a culling pass if their <code>cullingPassIndex</code>es are set to the same value. The <code>cullingPassIndex</code> selects which <code>UnityXRCullingPass</code> to use. Culling passes must be filled out in <code>UnityXRNextFrameDesc</code>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../samples/samples.html" title="Samples" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Samples
              </span>
            </div>
          </a>
        
        
          <a href="changelog.html" title="Display Changelog" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Display Changelog
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../img/toggle.js"></script>
      
    
    
      
    
  </body>
</html>